The "clusterman" Service
=======================

Clusterman is an autoscaler for Mesos clusters that will also provide
capabilities to simulate and predict how changes to autoscaling logic will
impact the cost, performance, and resource utilization of the applications,
allowing us to effectively optimize those metrics. This service will run the
batches and tasks for metrics collection, autoscaling, and analysis.

This is a batch/daemon only service. You can run batches by doing something like

    # Using paasta local-run
    $ paasta local-run --cluster norcal-devc --instance main --cmd 'exec dumb-init python {cmd}'

    # Note that you must ensure using the virtualenv from your service
    $ make virtualenv_run && source virtualenv_run/bin/activate

The documentation for this service should be available at:

    http://servicedocs.yelpcorp.com/docs/clusterman/index.html


How To Service
==============

Please read the update documentation to learn more about services at Yelp,
best practices, and how to extend your service to do all the cool things
you want to do with it:

    https://confluence.yelpcorp.com/display/ENG/HowToService
    http://servicedocs.yelpcorp.com/docs/tutorial_happyhour/index.html

Steps for first-time setup
==========================
To download the source code:

    $ git clone git@git.yelpcorp.com:services/clusterman

To use the newest version of clusterman_metrics package:

    $ upgrade-requirements -i https://pypi.yelpcorp.com/simple
    $ make clean
    $ make

How to run tests
================

    # For unit tests:
    $ make test

    # For paasta service tests:
    paasta local-run --cluster norcal-devc --instance testing --cmd '<Your testing command>'


How To Release a new version
============================
To merge branch to master and release

    # Update master to the newest version
    $ git checkout master
    $ git pull

    # Using no fast forward merge to master
    $ git merge --no-ff <branch-name>

    # Version bump for debian package. This will pop up an editor to modify __init__.py and debian/changelog
    # Update version to X.X.X. We use semver for version bump. http://semver.org/
    $ make version-bump

    # Release version X.X.X
    $ git push origin master --tag


Location of Jenkin pipelines
============================

    # For Clusterman Service:
    https://jenkins-paasta.yelpcorp.com/job/services-clusterman/

    # For Clusterman debian package:
    https://jenkins-george.yelpcorp.com/job/packages-clusterman/

For Additional Information
==========================

    # For CEP:
    y/clusterman-cep

    # For SCF:
    y/clusterman-scf

    # Issue tracking at JIRA:
    y/clusterman-jira

    # Documentation:
    http://servicedocs.yelpcorp.com/docs/clusterman/index.html

    # Roadmap:
    y/dsp-okrs

    # Runbook
    y/rb-clusterman
