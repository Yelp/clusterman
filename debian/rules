#!/usr/bin/make -f
# -*- makefile -*-

PIP_INDEX_URL ?= https://pypi.yelpcorp.com/simple

ifeq ($(CLUSTERMAN_ENV),YELP)
	YELP_DH_VIRTUALENV = --preinstall=-rrequirements-bootstrap.txt --pip-tool=pip-custom-platform --extra-pip-arg --only-binary=:all:
	YELP_DH_INSTALL = install -d completions/usr debian/package/.
endif

%:
	dh $@ --with python-virtualenv

override_dh_virtualenv:
	dh_virtualenv -i $(PIP_INDEX_URL) --python=/usr/bin/python3.7 $(YELP_DH_VIRTUALENV)

override_dh_install:
	dh_install
	$(YELP_DH_INSTALL)

override_dh_shlibdeps:
	dh_shlibdeps --exclude matplotlib --exclude numpy
